{% with id=widget.attrs.id %}
    <div {% if id %}id="{{ id }}"{% endif %} class="pill-container">
        {% for group, options, index in widget.optgroups %}
            {% for option in options %}
                {% if option.value != '' %}
                    {% include option.template_name with widget=option %}
                {% endif %}
            {% endfor %}
        {% endfor %}
    </div>
    <script>
        (function() {
            var c = document.getElementById("{{ id }}");
            if (!c) return;
            var labels = c.querySelectorAll("label[for]");
            for (var i = 0; i < labels.length; i++) {
                (function(label) {
                    label.addEventListener("click", function(e) {
                        e.preventDefault();
                        var radio = document.getElementById(label.getAttribute("for"));
                        if (!radio) return;
                        if (radio.checked) {
                            radio.checked = false;
                        } else {
                            radio.checked = true;
                        }
                    });
                })(labels[i]);
            }
        })();
    </script>
{% endwith %}
